(()=>{"use strict";const t=document.querySelector(".create__button"),e=document.getElementById("create");async function o(t){try{const e=new Request(t,{method:"get"}),o=await fetch(e);return await o.json()}catch(t){console.log(t)}}function n(t){return Object.keys(t).map((e=>{const o=t[e];return o.id=e,o}))}async function s(t){await fetch(`https://something-92912-default-rtdb.firebaseio.com/posts/${t}.json`,{method:"delete"})}t.addEventListener("click",(function(t){t.target.classList.add("hide"),e.classList.remove("hide")}));const c=document.querySelector(".content");async function r(){const t=await o("https://something-92912-default-rtdb.firebaseio.com/posts.json");c.innerHTML="",async function(){const t=n(await o("https://something-92912-default-rtdb.firebaseio.com/posts.json"));let e=[];t.map((t=>{e.push(t.id)})),Array.from(document.querySelectorAll(".delete-post")).forEach((t=>{t.addEventListener("click",(async function(o){for(let o=0;o<e.length;o++)e[o]===t.id&&(await s(e[o]),t.parentElement.parentElement.remove())}))}))}();const e=n(t).map((t=>function(t){const e=t.title,o=t.text;let n=document.createElement("div");c.prepend(n),n.className="post",n.innerHTML=`\n\t<div class="post-box">\n\t\t<h2 class="post-title">${e}</h2>\n\t\t<button class="button button-primary delete-post" id="${t.id}">Удалить</button>\n\t</div>\n\t<p class="post-text hide">${o}</p>\n `,Array.from(document.querySelectorAll(".post-title")).forEach((t=>{t.addEventListener("click",a),t.style.backgroundColor=`rgb(${i(0,255)}, ${i(0,255)}, ${i(0,255)})`}))}(t)));c.insertAdjacentHTML("beforebegin",e.join(" ")),localStorage.clear()}document.getElementById("show-posts").addEventListener("click",(function(){l||(r(),c.innerHTML="",l=!0)}));let l=!1;function a(){this.parentElement.nextElementSibling.classList.toggle("hide")}function i(t,e){return Math.floor(Math.random()*(e-t+1)+t)}const d=document.querySelector(".notification__button"),u=document.querySelector(".notification");d.addEventListener("click",(()=>{u.style.top="-150%"}));const m=document.querySelector(".error-title"),f=document.querySelector(".error-text");function h(t,e){e.style.border="1px solid rgb(133, 133, 133)",t.classList.add("hide")}function p(t,e,o){0==e.length&&(t.classList.remove("hide"),localStorage.clear(),o.style.border="1px solid red"),e.length>0&&(o.style.border="1px solid rgb(133, 133, 133)",t.classList.add("hide"))}const y=document.querySelector(".form__button"),g=document.getElementById("title"),b=document.getElementById("textarea");function E(){let t=!0;return localStorage.setItem(g.value,b.value),Object.keys(localStorage).forEach((e=>{const o=localStorage[e];let n=!0;n=localStorage[e].length&&n,n&&h(f,b),n&&h(m,g),t=t&&n,0!=e.length&&0!=o.length||(p(m,e,g),p(f,o,b),t=!1)})),t}y.addEventListener("click",(async function(o){o.preventDefault(),E(),E()&&(Object.keys(localStorage).forEach((t=>{E&&async function(t){try{const e=new Request("https://something-92912-default-rtdb.firebaseio.com/posts.json",{method:"post",body:JSON.stringify(t)}),o=await fetch(e);await o.json()}catch(t){console.log(t)}}({title:t,text:localStorage[t]})})),g.value="",b.value="",u.style.top="40px",setTimeout((()=>{u.style.top="-150%"}),3e3),t.classList.remove("hide"),e.classList.add("hide"),setTimeout((()=>{r()}),300))})),g.addEventListener("input",(function(){g.style.border="1px solid rgb(141, 58, 189)"}))})();